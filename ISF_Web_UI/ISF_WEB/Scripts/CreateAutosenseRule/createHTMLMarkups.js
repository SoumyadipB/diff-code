
let StaticJson = { "scanType": [{ "scanName": "App Scan", "value": "appscan", "appType": [{ "appName": "customApp", "value": "customApp", "attributes": [{ "attrsName": "Window Title", "value": "APPLICATION_TITLE", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Not In", "value": "notin" }, { "opName": "Not In | Case Insensitive", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals | Case Insensitive", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Key Stroke", "value": "INPUT_BUFFER_KEYSTROKE", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Not In", "value": "notin" }, { "opName": "Not In | Case Insensitive", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals | Case Insensitive", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Key Event(Copy/Cut/Paste/Save/Quit/Undo/Enter/Print)", "value": "INPUT_BUFFER_KEYEVENT", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Not In", "value": "notin" }, { "opName": "Not In | Case Insensitive", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals | Case Insensitive", "value": "notequalscaseinsensitive" }] }] }, { "appName": "Putty", "value": "PuTTy", "attributes": [{ "attrsName": "Window Title", "value": "APPLICATION_TITLE", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Not In", "value": "notin" }, { "opName": "Not In | Case Insensitive", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals | Case Insensitive", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Key Stroke", "value": "INPUT_BUFFER_KEYSTROKE", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Not In", "value": "notin" }, { "opName": "Not In | Case Insensitive", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals | Case Insensitive", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Key Event(Copy/Cut/Paste/Save/Quit/Undo/Enter/Print)", "value": "INPUT_BUFFER_KEYEVENT", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Not In", "value": "notin" }, { "opName": "Not In | Case Insensitive", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals | Case Insensitive", "value": "notequalscaseinsensitive" }] }] }, { "appName": "Microsoft Word", "value": "Word", "attributes": [{ "attrsName": "Window Title", "value": "APPLICATION_TITLE", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Not In", "value": "notin" }, { "opName": "Not In | Case Insensitive", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals | Case Insensitive", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Key Stroke", "value": "INPUT_BUFFER_KEYSTROKE", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Not In", "value": "notin" }, { "opName": "Not In | Case Insensitive", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals | Case Insensitive", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Key Event(Copy/Cut/Paste/Save/Quit/Undo/Enter/Print)", "value": "INPUT_BUFFER_KEYEVENT", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Not In", "value": "notin" }, { "opName": "Not In | Case Insensitive", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals | Case Insensitive", "value": "notequalscaseinsensitive" }] }] }, { "appName": "Google Chrome", "value": "Google Chrome", "attributes": [{ "attrsName": "Window Title", "value": "APPLICATION_TITLE", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Not In", "value": "notin" }, { "opName": "Not In | Case Insensitive", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals | Case Insensitive", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Key Stroke", "value": "INPUT_BUFFER_KEYSTROKE", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Not In", "value": "notin" }, { "opName": "Not In | Case Insensitive", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals | Case Insensitive", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Key Event(Copy/Cut/Paste/Save/Quit/Undo/Enter/Print)", "value": "INPUT_BUFFER_KEYEVENT", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Not In", "value": "notin" }, { "opName": "Not In | Case Insensitive", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals | Case Insensitive", "value": "notequalscaseinsensitive" }] }] }, { "appName": "Firefox", "value": "Mozilla Firefox", "attributes": [{ "attrsName": "Window Title", "value": "APPLICATION_TITLE", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Not In", "value": "notin" }, { "opName": "Not In | Case Insensitive", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals | Case Insensitive", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Key Stroke", "value": "INPUT_BUFFER_KEYSTROKE", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Not In", "value": "notin" }, { "opName": "Not In | Case Insensitive", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals | Case Insensitive", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Key Event(Copy/Cut/Paste/Save/Quit/Undo/Enter/Print)", "value": "INPUT_BUFFER_KEYEVENT", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Not In", "value": "notin" }, { "opName": "Not In | Case Insensitive", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals | Case Insensitive", "value": "notequalscaseinsensitive" }] }] }, { "appName": "Notepad", "value": "Notepad", "attributes": [{ "attrsName": "Window Title", "value": "APPLICATION_TITLE", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Not In", "value": "notin" }, { "opName": "Not In | Case Insensitive", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals | Case Insensitive", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Key Stroke", "value": "INPUT_BUFFER_KEYSTROKE", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Not In", "value": "notin" }, { "opName": "Not In | Case Insensitive", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals | Case Insensitive", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Key Event(Copy/Cut/Paste/Save/Quit/Undo/Enter/Print)", "value": "INPUT_BUFFER_KEYEVENT", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Not In", "value": "notin" }, { "opName": "Not In | Case Insensitive", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals | Case Insensitive", "value": "notequalscaseinsensitive" }] }] }, { "appName": "IE", "value": "Internet Explorer", "attributes": [{ "attrsName": "Window Title", "value": "APPLICATION_TITLE", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Not In", "value": "notin" }, { "opName": "Not In | Case Insensitive", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals | Case Insensitive", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Key Stroke", "value": "INPUT_BUFFER_KEYSTROKE", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Not In", "value": "notin" }, { "opName": "Not In | Case Insensitive", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals | Case Insensitive", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Key Event(Copy/Cut/Paste/Save/Quit/Undo/Enter/Print)", "value": "INPUT_BUFFER_KEYEVENT", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Not In", "value": "notin" }, { "opName": "Not In | Case Insensitive", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals | Case Insensitive", "value": "notequalscaseinsensitive" }] }] }, { "appName": "Microsoft PPT", "value": "PowerPoint", "attributes": [{ "attrsName": "Window Title", "value": "APPLICATION_TITLE", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Not In", "value": "notin" }, { "opName": "Not In | Case Insensitive", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals | Case Insensitive", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Key Stroke", "value": "INPUT_BUFFER_KEYSTROKE", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Not In", "value": "notin" }, { "opName": "Not In | Case Insensitive", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals | Case Insensitive", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Key Event(Copy/Cut/Paste/Save/Quit/Undo/Enter/Print)", "value": "INPUT_BUFFER_KEYEVENT", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Not In", "value": "notin" }, { "opName": "Not In | Case Insensitive", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals | Case Insensitive", "value": "notequalscaseinsensitive" }] }] }, { "appName": "Microsoft Excel", "value": "Excel", "attributes": [{ "attrsName": "Sheets Name (Excel Only) (Available in 2.9+)", "value": "EXCEL_CURRENT_SHEET", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Not in", "value": "notin" }, { "opName": "Not in(Case Insensitive)", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals (Case Insensitive)", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Sheets(Excel Only) (Available in 3+)", "value": "EXCEL_SHEETS", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Not in", "value": "notin" }, { "opName": "Not in(Case Insensitive)", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals (Case Insensitive)", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Sheets Count(Excel Only)(Available in 3+)", "value": "EXCEL_SHEETS_COUNT", "operators": [{ "opName": "Greater Than", "value": "greaterthan" }, { "opName": "Lesser Than", "value": "lesserthan" }, { "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Greather Than Equals", "value": "greaterthanequals" }, { "opName": "Lesser Than Equals", "value": "lesserthanequals" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals (Case Insensitive)", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Window Title", "value": "APPLICATION_TITLE", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Not in", "value": "notin" }, { "opName": "Not in(Case Insensitive)", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals (Case Insensitive)", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Key Stroke", "value": "INPUT_BUFFER_KEYSTROKE", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Not in", "value": "notin" }, { "opName": "Not in(Case Insensitive)", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals (Case Insensitive)", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Key Event(Copy/Cut/Paste/Save/Quit/Undo/Enter/Print)", "value": "INPUT_BUFFER_KEYEVENT", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Not in", "value": "notin" }, { "opName": "Not in(Case Insensitive)", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals (Case Insensitive)", "value": "notequalscaseinsensitive" }] }] }] }, { "scanName": "File System Scan", "value": "filesystem", "selectLoc": [{ "locName": "customPath", "value": "customPath", "attributes": [{ "attrsName": "Folder", "value": "FOLDER_NAME", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Not in", "value": "notin" }, { "opName": "Not in(Case Insensitive)", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals (Case Insensitive)", "value": "notequalscaseinsensitive" }] }, { "attrsName": "File", "value": "FILE_NAME", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Not in", "value": "notin" }, { "opName": "Not in(Case Insensitive)", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals (Case Insensitive)", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Extension", "value": "FILE_EXTENSION", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Not in", "value": "notin" }, { "opName": "Not in(Case Insensitive)", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals (Case Insensitive)", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Nesting Level (0-3)", "value": "nested_level", "operators": [{ "opName": "Lesser Than", "value": "lesserthan" }, { "opName": "Equals", "value": "equals" }, { "opName": "Lesser Than Equals", "value": "lesserthanequals" }] }, { "attrsName": "Folder Event(createAndModify/modify)", "value": "FOLDER_OPERATION", "operators": [{ "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }] }, { "attrsName": "File Event(createAndModify/modify/delete)", "value": "FILE_OPERATION", "operators": [{ "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }] }] }, { "locName": "Desktop(Current Users)", "value": "Desktop", "attributes": [{ "attrsName": "Folder", "value": "FOLDER_NAME", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Not in", "value": "notin" }, { "opName": "Not in(Case Insensitive)", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals (Case Insensitive)", "value": "notequalscaseinsensitive" }] }, { "attrsName": "File", "value": "FILE_NAME", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Not in", "value": "notin" }, { "opName": "Not in(Case Insensitive)", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals (Case Insensitive)", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Extension", "value": "FILE_EXTENSION", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Not in", "value": "notin" }, { "opName": "Not in(Case Insensitive)", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals (Case Insensitive)", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Nesting Level (0-3)", "value": "nested_level", "operators": [{ "opName": "Lesser Than", "value": "lesserthan" }, { "opName": "Equals", "value": "equals" }, { "opName": "Lesser Than Equals", "value": "lesserthanequals" }] }, { "attrsName": "Folder Event(createAndModify/modify)", "value": "FOLDER_OPERATION", "operators": [{ "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }] }, { "attrsName": "File Event(createAndModify/modify/delete)", "value": "FILE_OPERATION", "operators": [{ "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }] }] }, { "locName": "Documents", "value": "Documents", "attributes": [{ "attrsName": "Folder", "value": "FOLDER_NAME", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Not in", "value": "notin" }, { "opName": "Not in(Case Insensitive)", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals (Case Insensitive)", "value": "notequalscaseinsensitive" }] }, { "attrsName": "File", "value": "FILE_NAME", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Not in", "value": "notin" }, { "opName": "Not in(Case Insensitive)", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals (Case Insensitive)", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Extension", "value": "FILE_EXTENSION", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Not in", "value": "notin" }, { "opName": "Not in(Case Insensitive)", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals (Case Insensitive)", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Nesting Level (0-3)", "value": "nested_level", "operators": [{ "opName": "Lesser Than", "value": "lesserthan" }, { "opName": "Equals", "value": "equals" }, { "opName": "Lesser Than Equals", "value": "lesserthanequals" }] }, { "attrsName": "Folder Event(createAndModify/modify)", "value": "FOLDER_OPERATION", "operators": [{ "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }] }, { "attrsName": "File Event(createAndModify/modify/delete)", "value": "FILE_OPERATION", "operators": [{ "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }] }] }, { "locName": "Downloads", "value": "Downloads", "attributes": [{ "attrsName": "Folder", "value": "FOLDER_NAME", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Not in", "value": "notin" }, { "opName": "Not in(Case Insensitive)", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals (Case Insensitive)", "value": "notequalscaseinsensitive" }] }, { "attrsName": "File", "value": "FILE_NAME", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Not in", "value": "notin" }, { "opName": "Not in(Case Insensitive)", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals (Case Insensitive)", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Extension", "value": "FILE_EXTENSION", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Not in", "value": "notin" }, { "opName": "Not in(Case Insensitive)", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals (Case Insensitive)", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Nesting Level (0-3)", "value": "nested_level", "operators": [{ "opName": "Lesser Than", "value": "lesserthan" }, { "opName": "Equals", "value": "equals" }, { "opName": "Lesser Than Equals", "value": "lesserthanequals" }] }, { "attrsName": "Folder Event(createAndModify/modify)", "value": "FOLDER_OPERATION", "operators": [{ "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }] }, { "attrsName": "File Event(createAndModify/modify/delete)", "value": "FILE_OPERATION", "operators": [{ "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }] }] }, { "locName": "Absolute Path", "value": "Absolute Path", "attributes": [{ "attrsName": "Folder", "value": "FOLDER_NAME", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Not in", "value": "notin" }, { "opName": "Not in(Case Insensitive)", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals (Case Insensitive)", "value": "notequalscaseinsensitive" }] }, { "attrsName": "File", "value": "FILE_NAME", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Not in", "value": "notin" }, { "opName": "Not in(Case Insensitive)", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals (Case Insensitive)", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Extension", "value": "FILE_EXTENSION", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Not in", "value": "notin" }, { "opName": "Not in(Case Insensitive)", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals (Case Insensitive)", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Nesting Level (0-3)", "value": "nested_level", "operators": [{ "opName": "Lesser Than", "value": "lesserthan" }, { "opName": "Equals", "value": "equals" }, { "opName": "Lesser Than Equals", "value": "lesserthanequals" }] }, { "attrsName": "Folder Event(createAndModify/modify)", "value": "FOLDER_OPERATION", "operators": [{ "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }] }, { "attrsName": "File Event(createAndModify/modify/delete)", "value": "FILE_OPERATION", "operators": [{ "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }] }] }] }, { "scanName": "Email Scan", "value": "emailscan", "LookForPastEmail": [{ "attributes": [{ "attrsName": "From Email (Inbox)", "value": "INBOX_FROM_EMAIL", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Not in", "value": "notin" }, { "opName": "Not in(Case Insensitive)", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals (Case Insensitive)", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Subject (Inbox)", "value": "INBOX_SUBJECT", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Not in", "value": "notin" }, { "opName": "Not in(Case Insensitive)", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals (Case Insensitive)", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Body (Inbox)", "value": "INBOX_BODY", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Not in", "value": "notin" }, { "opName": "Not in(Case Insensitive)", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals (Case Insensitive)", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Attachment (Inbox)", "value": "INBOX_ATTACHMENT", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Not in", "value": "notin" }, { "opName": "Not in(Case Insensitive)", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals (Case Insensitive)", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Attachment Count (Inbox)", "value": "INBOX_ATTACHMENT_COUNT", "operators": [{ "opName": "Greater Than", "value": "greaterthan" }, { "opName": "Lesser Than", "value": "lesserthan" }, { "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Greather Than Equals", "value": "greaterthanequals" }, { "opName": "Lesser Than Equals", "value": "lesserthanequals" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals (Case Insensitive)", "value": "notequalscaseinsensitive" }] }, { "attrsName": "To Email (Sent)", "value": "SENT_TO_EMAIL", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Not in", "value": "notin" }, { "opName": "Not in(Case Insensitive)", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals (Case Insensitive)", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Subject (sent)", "value": "SENT_SUBJECT", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Not in", "value": "notin" }, { "opName": "Not in(Case Insensitive)", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals (Case Insensitive)", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Body (Sent)", "value": "SENT_BODY", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Not in", "value": "notin" }, { "opName": "Not in(Case Insensitive)", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals (Case Insensitive)", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Attachment (Sent)", "value": "SENT_ATTACHMENT", "operators": [{ "opName": "Contains", "value": "contains" }, { "opName": "Contains | Case Insensitive", "value": "containscaseinsensitive" }, { "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Not in", "value": "notin" }, { "opName": "Not in(Case Insensitive)", "value": "notincaseinsensitive" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals (Case Insensitive)", "value": "notequalscaseinsensitive" }] }, { "attrsName": "Attachment Count(Sent)", "value": "SENT_ATTACHMENT_COUNT", "operators": [{ "opName": "Greater Than", "value": "greaterthan" }, { "opName": "Lesser Than", "value": "lesserthan" }, { "opName": "Equals", "value": "equals" }, { "opName": "Equals | Case Insensitive", "value": "equalscaseinsensitive" }, { "opName": "Greather Than Equals", "value": "greaterthanequals" }, { "opName": "Lesser Than Equals", "value": "lesserthanequals" }, { "opName": "Not Equals", "value": "notequals" }, { "opName": "Not Equals (Case Insensitive)", "value": "notequalscaseinsensitive" }] }] }] }] };

/* Populate App Match Attribute */
function appMatchPopulateAttrs(neighbor, selectedFieldValue, element, isCheckbox = false) {
    let filtered = [];
    if (selectedFieldValue != '-1' && selectedFieldValue.length != 0) {
        for (var i = 0; i < selectedFieldValue.length; i++) {
            let tempFilteredVal = [];
            tempFilteredVal = StaticJson.scanType[0].appType.filter(function (el) { return el.value === selectedFieldValue[i] });
            filtered.push(tempFilteredVal[0]);
        }
    }
    //this is done becoz id "Select App" is selected and trigger on close is checked the match values should get disabled.
    else {
        let tempFilteredVal = [];
        tempFilteredVal = StaticJson.scanType[0].appType.filter(function (el) { return el.value === 'customApp' });
        filtered.push(tempFilteredVal[0]);
    }
    //let filtered = StaticJson.scanType[0].appType.filter(function (el) { return el.value === selectedFieldValue });
    let appMatchArray = '';
    if (filtered.length != 0) {
        appMatchArray = [{
            tagName: 'option',
            textContent: 'Select Attribute',
            attributes: {
                'value': '-1',
                'disabled': 'true'
            }
        }];
        for (let i in filtered) {
            filtered[i].attributes.map(function (attr) {
                let tempVal = '';

                if (isCheckbox) {
                    if (attr.value == 'APPLICATION_TITLE') {
                        tempVal = {
                            tagName: 'option',
                            textContent: attr.attrsName,
                            attributes: {
                                'value': attr.value,
                                'disabled': false
                            }
                        }
                    }
                    else {
                        tempVal = {
                            tagName: 'option',
                            textContent: attr.attrsName,
                            attributes: {
                                'value': attr.value,
                                'disabled': isCheckbox
                            }
                        }
                    }
                }
                else {
                    tempVal = {
                        tagName: 'option',
                        textContent: attr.attrsName,
                        attributes: {
                            'value': attr.value
                        }
                    }
                }
                 appMatchArray.push(tempVal);
                // return tempVal;
            });            
        }
        //Remove duplicate values 
        let jsonObject = appMatchArray.map(JSON.stringify);
        let uniqueSet = new Set(jsonObject);
        appMatchArray = Array.from(uniqueSet).map(JSON.parse);
    }
    neighbor.set({
        size: { width: 210, height: 200 }
    });

    
    neighbor.set('htmlMarkup', joint.shapes.html.AppMatch.getHTMLMarkup({
        appMatchOptions: appMatchArray
    })
    );
    neighbor.prop('fields/matchattr', '-1');
    neighbor.prop('fields/operator', '-1');
    neighbor.prop('fields/matchType', '-1');

    //Removing 'customApp' from appScan fields bcoz appScan rules are not getting saved
    let appFieldsArr = [];
    appFieldsArr = element.attributes.fields.app;
    if (appFieldsArr != '-1' && appFieldsArr != undefined) {

        appFieldsArr = appFieldsArr.filter(function (e) { return e !== 'customApp' });
    }
    element.attributes.fields.app = appFieldsArr;

}

function filterMatchOperatorMultiple(sourceElementValue, selectedFieldValue, newMarkup) {
    let tempFilterVal = []; let filtered = [];
    if (sourceElementValue != '-1') {
        for (let i in sourceElementValue) {
            tempFilterVal = StaticJson.scanType[0].appType.filter(function (el) { return el.value === sourceElementValue[i]; });
            filtered.push(tempFilterVal[0]);
        }

        for (let j in filtered) {
            let length = filtered[j].attributes.length;
            let appMatchOperatorArray = [];
            for (let i = 0; i < length; i++) {
                if (filtered[j].attributes[i].value == selectedFieldValue) {

                    appMatchOperatorArray = [{
                        tagName: 'option',
                        textContent: 'Select Operator',
                        attributes: {
                            'value': '-1',
                            'disabled': 'true'
                        }
                    }].concat(filtered[j].attributes[i].operators.map(function (op) {

                        return {
                            tagName: 'option',
                            textContent: op.opName,
                            attributes: {
                                'value': op.value
                            }
                        }
                    }
                    ));
                    newMarkup[1].children[2].children[0].children = appMatchOperatorArray;
                }
            }
        }
    }
    return newMarkup;

}

function appMatchOperatorGenerator(element, opt, _collections, selectedFieldValue) {

    let sourceElementValue = '';
    const htmlMarkup = element.get('htmlMarkup');
    let newMarkup;

    (!htmlMarkup) ? newMarkup = getScanHTMLMarkup() : newMarkup = joint.util.cloneDeep(htmlMarkup);

    let neighbors = graph.getNeighbors(element, { inbound: true });

    if (neighbors.length != 0) {
        if (neighbors[0].get('type') == "html.AppCondition") {
            let sourceOfAppCondition = graph.getNeighbors(neighbors[0], { inbound: true })[0];
            sourceElementValue = sourceOfAppCondition.get('fields').app;
        }
        else { sourceElementValue = neighbors[0].attributes.fields.app; }

        //IF multiple AppScan selected
        newMarkup = filterMatchOperatorMultiple(sourceElementValue, selectedFieldValue, newMarkup);

        let selectDynamicField = newMarkup[1].children.filter(function (el) { return (el.tagName === 'select' && el.attributes['data-attribute'] == "dynamicField") })
        let disableNeidMarket = false;

        //Code to disable the @node@ and @market@ on change of app match attr
        if (selectDynamicField.length != 0) {
            if (selectedFieldValue == 'APPLICATION_TITLE') {
                    disableNeidMarket = false;
                }
                else {
                    disableNeidMarket = true;
                }
            selectDynamicField[0].children[3].attributes.disabled = disableNeidMarket;
            selectDynamicField[0].children[8].attributes.disabled = disableNeidMarket;
        }
        //element.prop('fields/operator', '-1');
        //element.prop('fields/matchType', '-1');
        //element.prop('fields/dynamicField', '');
        //element.prop('fields/defaultValueForDynamic', '');
        //element.prop('fields/static', '');
        element.prop('fields/operator', '-1');
        element.set('htmlMarkup', newMarkup); changeHTMLMarkupForMatchingType(element, '', '');

    }
}

function getAppMatchHTMLMarkup({ appMatchOptions = [] } = {}) {
    if (appMatchOptions.length == 0) {
        appMatchOptions = [
            {
                tagName: "option", textContent: "Select Attribute",
                attributes: { value: "-1", disabled: "true", selected:"selected" }
            },
            {
                tagName: "option", textContent: "Window Title",
                attributes: { "value": "APPLICATION_TITLE" }
            },
            {
                tagName: "option", textContent: "Key Stroke",
                attributes: { "value": "INPUT_BUFFER_KEYSTROKE" }
            },
            {
                tagName: "option", textContent: "Key Event(Copy/Cut/Paste/Save/Quit/Undo/Enter/Print)",
                attributes: { "value": "INPUT_BUFFER_KEYEVENT" }
            }]    
    }


    return [{
        tagName: 'label',
        className: 'html-element-header',
        textContent: 'App Match',
    },
    {
        tagName: 'div',
        className: 'html-element-group',
        children: [
            {
                tagName: 'label',
                className: 'html-element-label',
                textContent: 'Attributes*',
                children: [{
                    tagName: 'select',
                    className: 'html-element-field',
                    groupSelector: 'field',
                    attributes: {
                        'data-attribute': 'matchattr',
                        'placeholder': 'Attribute'
                        
                    },
                    style: {
                        'pointer-events': 'auto'
                    },
                    children: appMatchOptions,
                }]
            },
            {
                tagName: 'label',
                className: 'html-element-label',
                textContent: 'Matching Type*',
                children: [{
                    tagName: 'select',
                    className: 'html-element-field',
                    groupSelector: 'field',
                    attributes: {
                        'data-attribute': 'matchType',
                        'placeholder':'Matching Type'
                    },
                    style: {
                        'pointer-events': 'auto'
                    },
                    children: [{
                        tagName: 'option',
                        textContent: 'Select Matching Type',
                        attributes: {
                            'value': '-1',
                            'disabled':'true'
                        }
                    }, 
                        {
                        tagName: 'option',
                        textContent: 'Static',
                        attributes: {
                            'value': 'static'
                        }
                    }, {
                        tagName: 'option',
                        textContent: 'Dynamic',
                        attributes: {
                            'value': 'dynamic'
                        }
                    }, {
                        tagName: 'option',
                        textContent: 'Static+Dynamic',
                        attributes: {
                            'value': 'staticanddynamic'
                        }
                    }, {
                        tagName: 'option',
                        textContent: 'Dynamic+Static',
                        attributes: {
                            'value': 'dynamicandstatic'
                        }
                    }]
                }]
            },
            {
                tagName: 'label',
                className: 'html-element-label',
                textContent: 'Operators*',
                children: [{
                    tagName: 'select',
                    className: 'html-element-field',
                    groupSelector: 'field',
                    attributes: {
                        'data-attribute': 'operator',
                        'placeholder':'Operator'
                    },
                    style: {
                        'pointer-events': 'auto'
                    },
                    children: [
                        { "tagName": "option", "textContent": "Select Operator", "attributes": { "value": "-1", "disabled": "true" } },
                        { "tagName": "option", "textContent": "Contains", "attributes": { "value": "contains" } },
                        { "tagName": "option", "textContent": "Contains | Case Insensitive", "attributes": { "value": "containscaseinsensitive" } },
                        { "tagName": "option", "textContent": "Equals | Case Insensitive", "attributes": { "value": "equalscaseinsensitive" } },
                        { "tagName": "option", "textContent": "Equals", "attributes": { "value": "equals" } },
                        { "tagName": "option", "textContent": "Not In", "attributes": { "value": "notin" } },
                        { "tagName": "option", "textContent": "Not In | Case Insensitive", "attributes": { "value": "notincaseinsensitive" } },
                        { "tagName": "option", "textContent": "Not Equals", "attributes": { "value": "notequals" } },
                        { "tagName": "option", "textContent": "Not Equals | Case Insensitive", "attributes": { "value": "notequalscaseinsensitive" } }
                    ]
                }]
            }
           
        ]
        },
       
    ];
}

/* Populate File System Match Attribute */
function fileMatchPopulateAttrs(neighbor, selectedFieldValue, element) {
    let filtered = StaticJson.scanType[1].selectLoc.filter(function (el) { return el.value === selectedFieldValue[0] });
    let fileMatchArray = '';
    if (filtered.length != 0) {
        fileMatchArray = [{
            tagName: 'option',
            textContent: 'Select Attribute',
            attributes: {
                'value': '-1',
                'disabled': 'true'
            }
        }].concat(filtered[0].attributes.map(function (attr) {

            return {
                tagName: 'option',
                textContent: attr.attrsName,
                attributes: {
                    'value': attr.value
                }
            }
        }
        ));
    }
    neighbor.set({
        size: { width: 230, height: 200 }
    });
    neighbor.set('htmlMarkup', joint.shapes.html.FileMatch.getHTMLMarkup({
        fileMatchOptions: fileMatchArray
    })
    );
    neighbor.prop('fields/matchattr', '-1');
    neighbor.prop('fields/operator', '-1');
    neighbor.prop('fields/matchType', '-1'); //changeHTMLMarkupForMatchingType(neighbor, '', '');
   
}

function fileMatchOperatorGenerator(element, opt, _collections, selectedFieldValue) {
    let sourceElementValue = '';
    const htmlMarkup = element.get('htmlMarkup');
    let newMarkup;
    if (!htmlMarkup) {
        newMarkup = getScanHTMLMarkup();
    } else {
        newMarkup = joint.util.cloneDeep(htmlMarkup);
    }
    let neighbors = graph.getNeighbors(element, { inbound: true });

    //if scanner is connected to AND/Or Condition 
    if (neighbors.length != 0) {
        if (neighbors[0].get('type') == "html.FileCondition") {
            let sourceOfAppCondition = graph.getNeighbors(neighbors[0], { inbound: true })[0];
            sourceElementValue = sourceOfAppCondition.get('fields').app;
        }
        else { sourceElementValue = neighbors[0].attributes.fields.app; }
    }
    let filtered = StaticJson.scanType[1].selectLoc.filter(function (el) { return el.value === sourceElementValue; });
    let length = filtered[0].attributes.length;

    for (let i = 0; i < length; i++) {
        if (filtered[0].attributes[i].value == selectedFieldValue) {

            let appMatchOperatorArray = [
                {
                    tagName: 'option',
                    textContent: 'Select Operator',
                    attributes: {
                        'value': '-1',
                        'disabled': 'true'
                    }
                }].concat(filtered[0].attributes[i].operators.map(function (op) {

                    return {
                        tagName: 'option',
                        textContent: op.opName,
                        attributes: {
                            'value': op.value
                        }
                    }
                }
                ));
            newMarkup[1].children[2].children[0].children = appMatchOperatorArray;
        }
    }    

    if (element.prop('fields/matchType') != 'static)') {
        element.prop('fields/matchType', 'static');
    }

    //Changes in other elements of File Match based on Match attribute selected.
    let htmlForTextDiv = $(newMarkup)[1];
    
    let matchOpChildren = htmlForTextDiv.children[1].children[0].children; // All MatchType will be allowed in file and folder
   
    if (selectedFieldValue === 'FOLDER_OPERATION') {
   
        matchOpChildren[2].attributes.disabled = true; matchOpChildren[3].attributes.disabled = true;
        matchOpChildren[4].attributes.disabled = true
    }
    else if (selectedFieldValue === 'FILE_OPERATION') {
    
        matchOpChildren[2].attributes.disabled = true; matchOpChildren[3].attributes.disabled = true;
        matchOpChildren[4].attributes.disabled = true
    }
    else if (selectedFieldValue === 'nested_level') {
   
        matchOpChildren[2].attributes.disabled = true; matchOpChildren[3].attributes.disabled = true;
        matchOpChildren[4].attributes.disabled = true
    }
    else if (selectedFieldValue === 'FILE_EXTENSION') {
        matchOpChildren[2].attributes.disabled = true; matchOpChildren[3].attributes.disabled = true;
        matchOpChildren[4].attributes.disabled = true
    }
    else {
      
        matchOpChildren[2].attributes.disabled = false; matchOpChildren[3].attributes.disabled = false;
        matchOpChildren[4].attributes.disabled = false
    }
    element.prop('fields/operator', '-1');
    element.set('htmlMarkup', newMarkup); changeHTMLMarkupForMatchingType(element, '', '');
}

function getFSMatchHTMLMarkup({ fileMatchOptions = [] } = {}) {

    return [{
        tagName: 'label',
        className: 'html-element-header',
        textContent: 'FS Match',
    },
    {
        tagName: 'div',
        className: 'html-element-group',
        children: [
            {
                tagName: 'label',
                className: 'html-element-label',
                textContent: 'Attributes*',
                children: [{
                    tagName: 'select',
                    className: 'html-element-field',
                    groupSelector: 'field',
                    attributes: {
                        'data-attribute': 'matchattr',
                        'placeholder':'Attributes'
                    },
                    style: {
                        'pointer-events': 'auto'
                    },
                    children: fileMatchOptions,
                }]
            },
            {
                tagName: 'label',
                className: 'html-element-label',
                textContent: 'Matching Type*',
                children: [{
                    tagName: 'select',
                    className: 'html-element-field',
                    groupSelector: 'field',
                    attributes: {
                        'data-attribute': 'matchType',
                        'placeholder':'Matching Type'
                    },
                    style: {
                        'pointer-events': 'auto'
                    },
                    children: [{
                        tagName: 'option',
                        textContent: 'Select Matching Type',
                        attributes: {
                            'value': '-1',
                            'disabled':'true'
                        }
                    }, 
                    {
                        tagName: 'option',
                        textContent: 'Static',
                        attributes: {
                            'value': 'static'
                            
                        }
                    },
                        {
                        tagName: 'option',
                        textContent: 'Dynamic',
                        attributes: {
                            'value': 'dynamic'
                        }
                    }, {
                        tagName: 'option',
                        textContent: 'Static+Dynamic',
                        attributes: {
                            'value': 'staticanddynamic'
                        }
                    }, {
                        tagName: 'option',
                        textContent: 'Dynamic+Static',
                        attributes: {
                            'value': 'dynamicandstatic'
                        }
                        }
                    ]
                }]
            },
            {
                tagName: 'label',
                className: 'html-element-label',
                textContent: 'Operators*',
                children: [{
                    tagName: 'select',
                    className: 'html-element-field',
                    groupSelector: 'field',
                    attributes: {
                        'data-attribute': 'operator',
                        'placeholder':'Operator'
                    },
                    style: {
                        'pointer-events': 'auto'
                    }
                    
                }]
            },
            //{
            //    tagName: 'input',
            //    className: 'html-element-field',
            //    groupSelector: 'field',
            //    attributes: {
            //        'data-attribute': 'staticData',
            //        'placeholder': 'Static Text'
            //    },
            //    style: {
            //        'pointer-events': 'auto'
            //    }
            //}
          
        ]
    }];
}

/* Populate Email Match Attribute */
function emailMatchPopulateAttrs(neighbor, selectedFieldValue, element) {
    let filtered = StaticJson.scanType[2].LookForPastEmail;
    let emailMatchArray = '';
    if (filtered.length != 0) {
        emailMatchArray = [{
            tagName: 'option',
            textContent: 'Select Attribute',
            attributes: {
                'value': '-1',
                'disabled': 'true'
            }
        }].concat(filtered[0].attributes.map(function (attr) {

            return {
                tagName: 'option',
                textContent: attr.attrsName,
                attributes: {
                    'value': attr.value
                }
            }
        }
        ));
    }
    neighbor.set({
        size: { width: 210, height: 200 }
    });

    neighbor.set('htmlMarkup', joint.shapes.html.EmailMatch.getHTMLMarkup({
        emailMatchOptions: emailMatchArray
    })
    );
    neighbor.prop('fields/matchattr', '-1');
    neighbor.prop('fields/operator', '-1');
    neighbor.prop('fields/matchType', '-1');

}

function emailMatchOperatorGenerator(element, opt, _collections, selectedFieldValue) {

    const htmlMarkup = element.get('htmlMarkup');
    let newMarkup;
    if (!htmlMarkup) {
        newMarkup = getScanHTMLMarkup();
    } else {
        newMarkup = joint.util.cloneDeep(htmlMarkup);
    }
    //let neighbors = graph.getNeighbors(element, { inbound: true });
    //let sourceElementValue = neighbors[0].attributes.fields.app;
    let filtered = StaticJson.scanType[2].LookForPastEmail;
    let length = filtered[0].attributes.length;
    for (let i = 0; i < length; i++) {
        if (filtered[0].attributes[i].value == selectedFieldValue) {

            let appMatchOperatorArray = [{
                tagName: 'option',
                textContent: 'Select Operator',
                attributes: {
                    'value': '-1',
                    'disabled':'true'
                }
            }].concat(filtered[0].attributes[i].operators.map(function (op) {

                return {
                    tagName: 'option',
                    textContent: op.opName,
                    attributes: {
                        'value': op.value
                    }
                }
            }
            ));
            newMarkup[1].children[2].children[0].children = appMatchOperatorArray;
        }
    }
    //return newMarkup;

    let selectDynamicField = newMarkup[1].children.filter(function (el) { return (el.tagName === 'select' && el.attributes['data-attribute'] == "dynamicField") })
    let disableNeidMarket = false;

      //Code to disable the @node@ and @market@ on change of email match attr
    if (selectDynamicField.length != 0) {
        if (selectedFieldValue == 'INBOX_SUBJECT' || selectedFieldValue == 'SENT_SUBJECT' ) {
            disableNeidMarket = false;
        }
        else {
            disableNeidMarket = true;
        }
        selectDynamicField[0].children[3].attributes.disabled = disableNeidMarket;
        selectDynamicField[0].children[8].attributes.disabled = disableNeidMarket;
    }
    element.prop('fields/operator', '-1');
    element.set('htmlMarkup', newMarkup); changeHTMLMarkupForMatchingType(element, '', '');
   
}

function getEmailMatchHTMLMarkup({ emailMatchOptions = [] } = {}) {

    return [{
        tagName: 'label',
        className: 'html-element-header',
        textContent: 'Email Match',
    },
    {
        tagName: 'div',
        className: 'html-element-group',
        children: [
            {
                tagName: 'label',
                className: 'html-element-label',
                textContent: 'Attributes*',
                children: [{
                    tagName: 'select',
                    className: 'html-element-field',
                    groupSelector: 'field',
                    attributes: {
                        'data-attribute': 'matchattr',
                        
                    },
                    style: {
                        'pointer-events': 'auto'
                    },
                    children: emailMatchOptions,
                }]
            },
            {
                tagName: 'label',
                className: 'html-element-label',
                textContent: 'Matching Type*',
                children: [{
                    tagName: 'select',
                    className: 'html-element-field',
                    groupSelector: 'field',
                    attributes: {
                        'data-attribute': 'matchType',
                       
                    },
                    style: {
                        'pointer-events': 'auto'
                    },
                    children: [{
                        tagName: 'option',
                        textContent: 'Select Matching Type',
                        attributes: {
                            'value': '-1',
                            'disabled': 'true'
                        }
                    },{
                        tagName: 'option',
                        textContent: 'Static',
                        attributes: {
                            'value': 'static'
                            
                        }
                    }, {
                        tagName: 'option',
                        textContent: 'Dynamic',
                        attributes: {
                            'value': 'dynamic'
                        }
                    }, {
                        tagName: 'option',
                        textContent: 'Static+Dynamic',
                        attributes: {
                            'value': 'staticanddynamic'
                        }
                    }, {
                        tagName: 'option',
                        textContent: 'Dynamic+Static',
                        attributes: {
                            'value': 'dynamicandstatic'
                        }
                    }]
                }]
            },
            {
                tagName: 'label',
                className: 'html-element-label',
                textContent: 'Operators*',
                children: [{
                    tagName: 'select',
                    className: 'html-element-field',
                    groupSelector: 'field',
                    attributes: {
                        'data-attribute': 'operator',
                        
                    },
                    style: {
                        'pointer-events': 'auto'
                    }
                    
                }]
            }
           
        ]
    }];
}

//Function to Change the HTML Markup of the Match according to Matching Type
function changeHTMLMarkupForMatchingType(element, opt, fields) {

    let elementType = element.attributes.type; 
    let selectionValue = element.get('fields').matchType;
    let matchBBox = element.getBBox();
    matchBBox.height = 200;
    const htmlMarkup = element.get('htmlMarkup');
    let newMarkup;
    if (!htmlMarkup) {
        newMarkup = getScanHTMLMarkup();
    } else {
        newMarkup = joint.util.cloneDeep(htmlMarkup);
    }

    let newMarkupChildren = newMarkup[1].children;

    if (selectionValue == 'static') {
        element.prop('fields/staticData', '');

        let matchHTMLMarkupArray = {
            tagName: 'input',
            className: 'html-element-field',
            groupSelector: 'field',
            attributes: {
                'data-attribute': 'staticData',
                'placeholder': 'Static Text',
                'type':'text'
            },
            style: {
                'pointer-events': 'auto'
            }
        }
        //This below code is for change in Static Text input field.
        if (elementType == 'html.FileMatch') {
            let matchAttrSelected = element.get('fields').matchattr;
            let inputAttr = matchHTMLMarkupArray.attributes;

            if (inputAttr.onkeypress || inputAttr.min || inputAttr.max) {
                inputAttr.onkeypress = ''; inputAttr.min = ''; inputAttr.max = '';
            }
            if (matchAttrSelected === 'FOLDER_OPERATION') {
                inputAttr.placeholder = 'Static Text (createAndmodify/modify) allowed)';
                inputAttr.type = 'text';
            }
            else if (matchAttrSelected === 'nested_level') {
                inputAttr.placeholder = 'Static Text (number 0-3) allowed)';
                inputAttr.type = 'number'; inputAttr.min = '0'; inputAttr.max = '3';
                inputAttr.onkeypress = "return event.charCode >= 48 && event.charCode <= 57";
            }
            else if (matchAttrSelected == 'FILE_OPERATION') {
                inputAttr.placeholder = 'Static Text (createAndmodify/modify/delete) allowed)';
               inputAttr.type = 'text';
            }
            else {
                inputAttr.placeholder = 'Static Text';
                inputAttr.type = 'text';
            }
        }
      
        if (newMarkupChildren.length == 5) {
            newMarkupChildren.pop(newMarkupChildren.length - 1);
            newMarkupChildren.pop(newMarkupChildren.length - 1);
        }
        else if (newMarkupChildren.length == 4) {
            newMarkupChildren.pop(newMarkupChildren.length - 1);           
        }
        else if (newMarkupChildren.length > 5) {
            newMarkupChildren.pop(newMarkupChildren.length - 1);
            newMarkupChildren.pop(newMarkupChildren.length - 1);
            newMarkupChildren.pop(newMarkupChildren.length - 1);
        }
        newMarkupChildren.push(matchHTMLMarkupArray);
       
        matchBBox.height = matchBBox.height + 30;
        //newMarkup[1].children[4] = {};
    }

    else if (selectionValue == 'dynamic') {

        let matchAttrValue = element.prop('fields/matchattr');
        let disableNeidMarket = false;
        if (matchAttrValue == 'FOLDER_NAME' || matchAttrValue == 'FILE_NAME' || matchAttrValue == 'INBOX_SUBJECT' || matchAttrValue == 'SENT_SUBJECT' || matchAttrValue == 'APPLICATION_TITLE') {           
            disableNeidMarket = false;
        }
        else {
            disableNeidMarket = true;
        }
        element.prop('fields/defaultValueForDynamic', '');
        element.prop('fields/dynamicField', '-1');

        let matchDefualtValueHTMLMarkupArray = {
            tagName: 'input',
            className: 'html-element-field',
            groupSelector: 'field',
            attributes: {
                'data-attribute': 'defaultValueForDynamic',
                'placeholder': 'Default value for Dynamic selection'
            },
            style: {
                'pointer-events': 'auto'
            }
        }

        let matchHTMLMarkupArray = getDynamicFieldsMarkup(disableNeidMarket);

        if (newMarkupChildren.length == 4) {
            newMarkupChildren.pop(newMarkupChildren.length - 1);
        }

        else if (newMarkupChildren.length == 5) {

            newMarkupChildren.pop(newMarkupChildren.length - 1);
            newMarkupChildren.pop(newMarkupChildren.length - 1);
        }
        else if (newMarkupChildren.length > 5) {
            newMarkupChildren.pop(newMarkupChildren.length - 1);
            newMarkupChildren.pop(newMarkupChildren.length - 1);
            newMarkupChildren.pop(newMarkupChildren.length - 1);
        }
        newMarkupChildren.push(matchHTMLMarkupArray);
        newMarkupChildren.push(matchDefualtValueHTMLMarkupArray);
        matchBBox.height = matchBBox.height + 45;
        //newMarkup[1].children[4] = {};
    }

    else if (selectionValue == 'staticanddynamic') {

        let matchAttrValue = element.prop('fields/matchattr');
        let disableNeidMarket = false;
        if (matchAttrValue == 'FOLDER_NAME' || matchAttrValue == 'FILE_NAME' || matchAttrValue == 'INBOX_SUBJECT' || matchAttrValue == 'SENT_SUBJECT' || matchAttrValue == 'APPLICATION_TITLE') {
            disableNeidMarket = false;
        }
        else {
            disableNeidMarket = true;
        }

        element.prop('fields/defaultValueForDynamic', '');
        element.prop('fields/dynamicField', '-1');
        element.prop('fields/staticData', '');

        let matchDefualtValueHTMLMarkupArray = {
            tagName: 'input',
            className: 'html-element-field',
            groupSelector: 'field',
            attributes: {
                'data-attribute': 'defaultValueForDynamic',
                'placeholder': 'Default value for Dynamic selection'
            },
            style: {
                'pointer-events': 'auto'
            }
        }

        let matchHTMLMarkupStaticArray = {
            tagName: 'input',
            className: 'html-element-field',
            groupSelector: 'field',
            attributes: {
                'data-attribute': 'staticData',
                'placeholder': 'Static Text'
            },
            style: {
                'pointer-events': 'auto'
            }
        }        

        let matchHTMLDynamicMarkupArray = getDynamicFieldsMarkup(disableNeidMarket)

        if (newMarkupChildren.length == 4) {
            newMarkupChildren.pop(newMarkupChildren.length - 1);
        }
        else if (newMarkupChildren.length == 5) {
            newMarkupChildren.pop(newMarkupChildren.length - 1);
            newMarkupChildren.pop(newMarkupChildren.length - 1);
        }

        else if (newMarkupChildren.length > 5) {
            newMarkupChildren.pop(newMarkupChildren.length - 1);
            newMarkupChildren.pop(newMarkupChildren.length - 1);
            newMarkupChildren.pop(newMarkupChildren.length - 1);
        }
        newMarkupChildren.push(matchHTMLMarkupStaticArray);
        newMarkupChildren.push(matchHTMLDynamicMarkupArray);
        newMarkupChildren.push(matchDefualtValueHTMLMarkupArray);
        matchBBox.height = matchBBox.height + 70;
    }

    else if (selectionValue == 'dynamicandstatic') {

        let matchAttrValue = element.prop('fields/matchattr');
        let disableNeidMarket = false;
        if (matchAttrValue == 'FOLDER_NAME' || matchAttrValue == 'FILE_NAME' || matchAttrValue == 'INBOX_SUBJECT' || matchAttrValue == 'SENT_SUBJECT' || matchAttrValue == 'APPLICATION_TITLE') {
            disableNeidMarket = false;
        }
        else {
            disableNeidMarket = true;
        }

        element.prop('fields/defaultValueForDynamic', '');
        element.prop('fields/dynamicField', '-1');
        element.prop('fields/staticData', '');
        let matchDefualtValueHTMLMarkupArray = {
            tagName: 'input',
            className: 'html-element-field',
            groupSelector: 'field',
            attributes: {
                'data-attribute': 'defaultValueForDynamic',
                'placeholder': 'Default value for Dynamic selection'
            },
            style: {
                'pointer-events': 'auto'
            }
        }

        let matchHTMLMarkupStaticArray = {
            tagName: 'input',
            className: 'html-element-field',
            groupSelector: 'field',
            attributes: {
                'data-attribute': 'staticData',
                'placeholder': 'Static Text'
            },
            style: {
                'pointer-events': 'auto',
                'margin-top': '5px'
            },            
        }

        let matchHTMLDynamicMarkupArray = getDynamicFieldsMarkup(disableNeidMarket);
        if (newMarkupChildren.length == 4) {
            newMarkupChildren.pop(newMarkupChildren.length - 1);
        }
        else if (newMarkupChildren.length == 5) {
            newMarkupChildren.pop(newMarkupChildren.length - 1);
            newMarkupChildren.pop(newMarkupChildren.length - 1);
        }

        else if (newMarkupChildren.length > 5) {
            newMarkupChildren.pop(newMarkupChildren.length - 1);
            newMarkupChildren.pop(newMarkupChildren.length - 1);
            newMarkupChildren.pop(newMarkupChildren.length - 1);
        }
        newMarkupChildren.push(matchHTMLDynamicMarkupArray);
        newMarkupChildren.push(matchDefualtValueHTMLMarkupArray);
        newMarkupChildren.push(matchHTMLMarkupStaticArray);
        
        matchBBox.height = matchBBox.height + 70;
    }

    element.set('htmlMarkup', newMarkup);
    element.set({
        size: {
            width: 210,
            height: matchBBox.height
        }
    });
}

function createHTMLForEmailScanner(element, opt, selectedFieldValue) {
    const htmlMarkup = element.get('htmlMarkup');
    let newMarkup;
    if (!htmlMarkup) {
        newMarkup = getScanHTMLMarkup();
    } else {
        newMarkup = joint.util.cloneDeep(htmlMarkup);
    }
    let newMarkupChildren = newMarkup[1].children;
    let appHTMLMarkupArrayForEmail = {
        tagName: 'label',
        className: 'html-element-label',
        textContent: 'Time(Hours):',
        children: [{
            tagName: 'input',
            className: 'html-element-field',
            groupSelector: 'field',
            attributes: {
                'data-attribute': 'timeField',
                'placeholder': 'Time in Hours',
                'type': 'number',
                'onkeypress': "return event.charCode >= 48 && event.charCode <= 57",
                'min': "0",
        },  
        
        style: {
            'pointer-events': 'auto',
            'width':'100px'
            }
        }]
    }
    if (selectedFieldValue == true) {
        newMarkupChildren.push(appHTMLMarkupArrayForEmail);
    }
    else {
        newMarkupChildren.pop(newMarkupChildren.length - 1);
    }
    element.set('htmlMarkup', newMarkup);
}

function disableEnableInputPathForFSScan(element, opt, selectedFieldValue) {
    

    const htmlMarkup = element.get('htmlMarkup');
    let newMarkup;
    let fsScanMarkup;
    if (!htmlMarkup) {
        newMarkup = getScanHTMLMarkup();
    } else {
        newMarkup = joint.util.cloneDeep(htmlMarkup);
    }
    let childernMarkupForFSScan = newMarkup[3].children;

    if (selectedFieldValue == 'Absolute Path') {
         fsScanMarkup = {
            tagName: 'input',
            className: 'html-element-field',
            groupSelector: 'field',
            attributes: {
                'data-attribute': 'customPath',
                'placeholder': 'Path'

            },
            style: {
                'pointer-events': 'auto'
            }

        }
    }

    else {
        element.prop('fields/customPath', '');
         fsScanMarkup = {
            tagName: 'input',
            className: 'html-element-field',
            groupSelector: 'field',
            attributes: {
                'data-attribute': 'customPath',
                'placeholder': 'Path',
                'disabled':'disabled'

            },
            style: {
                'pointer-events': 'auto'
            }

        }


    }

    childernMarkupForFSScan.pop(childernMarkupForFSScan.length - 1);

    childernMarkupForFSScan.push(fsScanMarkup);
    element.set('htmlMarkup', newMarkup);

}

//Make Dynamic Fields dropdown
function getDynamicFieldsMarkup(disableNeidMarket) {
    return {
        tagName: 'select',
        className: 'html-element-field',
        groupSelector: 'field',
        attributes: {
            'data-attribute': 'dynamicField',

        },
        style: {
            'pointer-events': 'auto'
        },
        children: [{
            tagName: 'option',
            textContent: 'Select Dynamic Values',
            attributes: {
                'value': '-1',
                'disabled': 'true',
                'selected': 'selected',
            }
        }, {
            tagName: 'option',
            textContent: '@signum@',
            attributes: {
                'value': '@signum@'
            }
        }, {
            tagName: 'option',
            textContent: '@projectid@',
            attributes: {
                'value': '@projectid@'
            }
        }, {
            tagName: 'option',
            textContent: '@nodes@',
            attributes: {
                'value': '@nodes@',
                'disabled': disableNeidMarket
            }
        }, {
            tagName: 'option',
            textContent: '@customername@',
            attributes: {
                'value': '@customername@'
            }
        },
        {
            tagName: 'option',
            textContent: '@woname@',
            attributes: {
                'value': '@woname@'
            }
        },
        {
            tagName: 'option',
            textContent: '@startdate@',
            attributes: {
                'value': '@startdate@'
            }
        },
        {
            tagName: 'option',
            textContent: '@workflowname@',
            attributes: {
                'value': '@workflowname@'
            }
        },
        {
            tagName: 'option',
            textContent: '@market@',
            attributes: {
                'value': '@market@',
                'disabled': disableNeidMarket
            }
        },
        {
            tagName: 'option',
            textContent: '@wfdefid@',
            attributes: {
                'value': '@wfdefid@'
            }
        },
        {
            tagName: 'option',
            textContent: '@doid@',
            attributes: {
                'value': '@doid@'
            }
        },
        {
            tagName: 'option',
            textContent: '@subactname@',
            attributes: {
                'value': '@subactname@'
            }
        }]
    }
}
